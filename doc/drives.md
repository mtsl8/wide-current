### important context

information about dual booting with another os depends on how they boot. dual booting with Windows is possible and less complicated than it might look [here](https://wiki.archlinux.org/title/Dual_boot_with_Windows). grub can manage most modern systems. rEFInd I believe is used with Mac OS for dual booting. more to come on those subjects in the future...

the default path here assumes you are using a single free (== unused and prepared to be ERASED) HD; however you could fairly easily split things up between multiple drives. concepts such as encryption, LVM, and RAID are more complex, and will require a firm grasp of the basics.

there will be different approaches depending on:

a) the type of drive you are using:

* hard disk drives (HDD) are magnetic platter devices 
  * with virtually damageless writes to disk 
  * with limited physical durability
  * with limited data I/O speed
* solid state drives (SSD) are NAND flash memory
  * with a limited number of writes to each memory cell
  * with impressive physical durability
  * with high data I/O speed
  * with varying levels of built in drive management tools
* non-volatile memory express (NVMe) are NAND flash memory
  * SSD packaged for PCIe slots
  * with maximum I/O speed
  * with varying levels of built in hardware encryption

and<br>
b) the type of firmware your computer has available:

* basic input output system (BIOS)
  * is the old standard firmware
  * prefers MBR partition tables, or slightly modified GPT
  * expects boot information in a specific place at the beginning of the drive
  * is not configurable via runtime software interface
  * does not provide many security features
* unified extensible firmware interface (UEFI)
  * is the new standard firmware
  * prefers GPT partition tables
  * is fairly flexible and aware of bootable devices without extra help
  * can be modified and adjusted using EFI variables (efivars) at runtime
  * has varying levels of support for hardware based security, including 
    * secure boot
    * machine owner keys
    * trusted platform module (TPM) managment

### deciding how to allocate space

deciding how much to allocate for what depends on what you want to do with the system.

using a small EFI boot partition is possible as long as you store your kernels on the root partition, which is wide-default. some older UEFI implementations have issues if you make it too small - see [here](https://www.rodsbooks.com/efi-bootloaders/principles.html) - so 550M is a good safe number. if you are using BIOS/MBR you don't need a seperate boot partition, but it can make things easier for encryption or for multi-booting different operating systems<br>

swap partition is not mandatory but a backup for RAM and recommended on HDD's - a swap file can be used instead on SSD's (or just run swapless if you like living on the edge...) 

* if you overflow RAM without swap in place, your system will crawl / hang / kernel panic.
* swap can also be used for hibernation, in which case you need to allocate a bit more than the amount of used RAM in order to hibernate the RAM to the hard drive.
* if you use encryption, consider the security implications of using unencrypted swap.. [solutions]()
* keeping in mind SSD's limited write cycles, in those cases it is preferable to use a swapfile and the hard drive's built in TRIM to rotate the drive, rather than burn out a fixed partition<br>

the root partition can be (significantly) smaller than 40 if the system is light/minimal. I usually use 100 if the drive is big because .. why not?

there are some reasons you might want to break root into /var /tmp /data or the like, but that won't be covered here. usually that is more relevant for hardening shared (server) resources to prevent casual overflow from heavy use or malicious attempts to crash the system.

home at minimum needs to be at least enough to store user configuration and working files, so it's not _required_ to be very large, but it can be if you like. this is where all the files generated by your user will be kept by default. home is not required to be seperate from root, but it does contain an entirely different context, so it is generally recommended - to have clearer awareness of drive usage, or to make managing backups easier; for example.

one could use a seperate partition or drive for audio and yet another larger one for video. another possible use of a seperate partition would be a "vault" for example, to keep encrypted data seperately secure without complicating the rest of the system. perhaps you have an external drive with your music library, which you leave plugged in and want to be automounted on boot.. _\[any extra partitions can be mounted based on the type of user permissions you want them to have: the root user owns "/\*" including "/home/" ; each user owns their "/home/$user/" directory and everything it contains by default.\]_

### partitioning a drive

replace "X" in "sdX" with the letter of the drive you are working on:
```

lsblk -f

HD="/dev/sdX"

fdisk $HD

# or whichever partition tool you want to use..
# (new GPT table)
# ...
# BOOT: 100M +efi/esp/boot flag
# SWAP: 4G linux swap
# ROOT: 40G linux root
# HOME: 100G linux filesystem
```
### format
```
mkfs.fat -F 32 "$HD"1
fatlabel "$HD"1 BOOT
mkswap -L SWAP "$HD"2 
mkfs.ext4 -L ROOT "$HD"3
mkfs.ext4 -L HOME "$HD"4
```
### erase, encrypt ~ incomplete, optional

Encryption ontop of all 1's or straight 0's is not very strong. encryption on random is.<br>
one can use /dev/urandom alone but it's a lot faster to use openssl

NAND memory (flash, SSD, NVMe) does not enjoy being bit blasted; it reduces their lifespan <br>
more sophisticated devices have built in harware encryption made for the drive. <br>
buy those / use that !! not actually too pricey for primo NVMe <br>
in order to factory reset SSD, see [here](https://wiki.archlinux.org/title/Solid_state_drive/Memory_cell_clearing) (check nearby if that doesn't cover your drive)

HDD's do not mind at all, but it will take a while.

replace "X" with the drive, and include a number "n" if you want to target a partition<br>
if the "n" is omitted the entire drive will be erased.<br>

many will use _dd_, but _cat_ or _pv_ are naturally faster.<br>
_pv_ will display progress, _cat_ will not.<br>

```
DEVICE="/dev/sdXn"

PASS=$(tr -cd '[:alnum:]' < /dev/urandom 2>/dev/null | head -c128)
openssl enc -aes-256-ctr -pass pass:"$PASS" -nosalt </dev/zero \
| pv > $DEVICE

```
see [here](https://wiki.archlinux.org/title/Dm-crypt) and [here](https://wiki.artixlinux.org/Main/InstallationWithFullDiskEncryption) for some light reading on the actual encryption part heh

the short version is, you can encrypt the entire drive as one device, or choose specific partitions to encrypt. the way you choose to encrypt has many potential consequences on how you boot, and extra steps to be taken by the bootloader and kernel to do so. LUKS2 is the standard encryption header system. there are ways to backup the header and also to add multiple password keys or keyfiles, which can be stored mentally, locally, or on a detachable drive.
